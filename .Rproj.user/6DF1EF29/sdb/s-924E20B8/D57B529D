{
    "collab_server" : "",
    "contents" : "---\ntitle: \"King Sejong's National Poll on Tax Reform(Korean)\"\nauthor: \"coop711\"\ndate: \"2015년 3월 29일\"\noutput: html_document\n---\n\nData Management\n---------------\n\n- 원자료는 세종실록, 요약표는 오기수 교수의 논문에서.\n\n```{r}\nload(\"sejong_poll_kr_2.rda\")\nstr(sejong.poll.kr.2)\nsejong.poll.kr.2\n```\n\n- 전체 찬반을 `xtabs()` 로 파악. `digits=3`의 역할에 유의\n\n```{r}\noptions(digits=3)\nxtabs(counts~vote, data=sejong.poll.kr.2)\nprop.table(xtabs(counts~vote, data=sejong.poll.kr.2))\n```\n\n- `col=` 을 이용하여 색으로 찬반구분. \n\n```{r}\nsejong.poll.kr.2$color[sejong.poll.kr.2$vote==\"찬성\"]<-\"cyan\"\nsejong.poll.kr.2$color[sejong.poll.kr.2$vote==\"반대\"]<-\"red\"\n```\n- 윗 식을 한줄로 줄이려면 `ifelse()`를 이용하여\n\n```{r}\ncolor<-ifelse(sejong.poll.kr.2$vote==\"찬성\", \"cyan\", \"red\")\n```\n\n\n```{r fig.width=4, fig.height=4}\npie(xtabs(counts~vote, data=sejong.poll.kr.2), col=sejong.poll.kr.2$color)\ntitle(main=\"전체 찬반\")\ntext(x=0, y=c(0.4,-0.4), labels=c(\"98,657\", \"74,149\"))\n```\n\n- 계급별 찬반.\n\n```{r}\nxtabs(counts~vote+class, data=sejong.poll.kr.2)\n```\n\n- 품관촌민의 수효가 상대적으로 많아서 별도로 분석.\n\n```{r}\nsejong.poll.kr.2$class.2<-ifelse(sejong.poll.kr.2$class==\"품관촌민\", \"품관촌민\", \"관료\")\n```\n\n- 관료와 품관촌민의 찬반 집계\n\n```{r}\nxtabs(counts~vote+class.2, data=sejong.poll.kr.2)\n```\n\n- 소계를 교차표의 주변에 계산.\n\n```{r}\naddmargins(xtabs(counts~vote+class.2, data=sejong.poll.kr.2))\n```\n\n- 비율을 계산하여 주변에 집계. \n\n```{r}\nprop.table(xtabs(counts~vote+class.2, data=sejong.poll.kr.2), margin=2)\n```\n\n- 관료와 품관촌민의 찬반을 Pie chart에 도식화\n\n```{r fig.width=8, fig.height=4}\nattach(sejong.poll.kr.2)\npar(mfrow=c(1,2))\npie(xtabs(counts~vote+class.2, data=sejong.poll.kr.2[class.2==\"관료\",], drop=T), labels=c(\"찬성\", \"반대\"), col=color)\ntitle(main=\"관료들의 찬반\")\ntext(x=0, y=c(0.4,-0.4), labels=c(\"915\", \"845\"))\npie(xtabs(counts~vote+class.2, data=sejong.poll.kr.2[class.2==\"품관촌민\",], drop=T), labels=c(\"찬성\", \"반대\"), col=color)\ntitle(main=\"품관촌민의 찬반\")\ntext(x=0, y=c(0.4,-0.4), labels=c(\"97,742\", \"73,304\"))\npar(mfrow=c(1,1))\n```\n\n- 관료와 품관촌민의 찬반을 지역별로 집계.\n\n```{r}\nxtabs(counts~vote+region, data=sejong.poll.kr.2[class.2==\"관료\",], drop=T)\nxtabs(counts~vote+region, data=sejong.poll.kr.2[class.2==\"품관촌민\",], drop=T)\n```\n\n- 서울은 다른 지역보다 월등히 많은 관료가 거주하므로 별도 집계.\n\n```{r}\nxtabs(counts~vote+class, data=sejong.poll.kr.2[region==\"서울\",], drop=T)\n```\n\n\n- 서울의 계급별 찬반을 barplot으로 그려봄. text()의 좌표는 locator()로 찾아냄.\n\n```{r}\nbarplot(xtabs(counts~vote+class, data=sejong.poll.kr.2[region==\"서울\",], drop=T), col=color)\ntitle(main=\"서울의 찬반\")\ntext(x=c(0.7, 1.9, 1.9, 3.1, 3.1), y=c(120, 450, 135, 500, 220), labels=c(\"194\",\"393\", \"259\", \"117\", \"443\"))\nlegend(\"topleft\", inset=0.05, fill=c(\"cyan\", \"red\"), legend=c(\"찬성\", \"반대\"))\n```\n\n- mosaicplot()의 활용.\n\n```{r}\nmosaicplot(xtabs(counts~class+vote, data=sejong.poll.kr.2[region==\"서울\",], drop=T), col=color, main=\"서울의 찬반\", xlab=\"계급\" , ylab =\"찬반\")\n```\n\n- 지역별 관료들의 찬반을 barplot()으로 그려봄.\n\n```{r}\nxtabs(counts~vote+region, data=sejong.poll.kr.2[class.2==\"관료\" & !region==\"서울\",], drop=T)\nbarplot(xtabs(counts~vote+region, data=sejong.poll.kr.2[class.2==\"관료\" & !region==\"서울\",], drop=T), col=color)\ntitle(main=\"지방 관료들의 찬반\")\nlegend(\"topleft\", inset=0.05, fill=c(\"cyan\", \"red\"), legend=c(\"찬성\", \"반대\"))\n```\n\n- mosaicplot()의 활용\n\n```{r}\nmosaicplot(xtabs(counts~region+vote, data=sejong.poll.kr.2[class.2==\"관료\" & !region==\"서울\",], drop=T), col=color, main=\"\", xlab=\"계급\", ylab=\"찬반\")\ntitle(main=\"지방 관료들의 찬반\")\n```\n\n- 품관촌민들의 지역별 찬반을 barplot()으로 요약.\n\n```{r}\nbarplot(xtabs(counts~vote+region, data=sejong.poll.kr.2[class.2==\"품관촌민\",], drop=T), col=color)\ntitle(main=\"품관촌민들의 지역별 찬반\")\nlegend(\"topleft\", inset=0.05, fill=c(\"cyan\", \"red\"), legend=c(\"찬성\", \"반대\"))\n```\n\n- mosaicplot()의 활용\n\n```{r}\nmosaicplot(xtabs(counts~region+vote, data=sejong.poll.kr.2[class.2==\"품관촌민\",], drop=T), col=color, main=\"품관촌민의 지역별 찬반\", xlab=\"지역\", ylab=\"찬반\")\n```\n\n- 충청도는 관료들의 찬반과 품관촌민의 찬반이 다른 곳.\n\n```{r}\nxtabs(counts~vote+class, data=sejong.poll.kr.2[region==\"충청\",], drop=T)\nprop.table(xtabs(counts~vote+class, data=sejong.poll.kr.2[region==\"충청\",], drop=T), margin=2)\nbarplot(prop.table(xtabs(counts~vote+class, data=sejong.poll.kr.2[region==\"충청\",], drop=T), margin=2), col=color, ylim=c(0, 1.5), axes=F)\naxis(side=2, at=c(0, 0.5, 1.0), labels=c(\"0\", \"50%\", \"100%\"))\ntitle(main=\"충청도의 계급별 찬반 비율\")\nlegend(\"topleft\", inset=0.05, fill=c(\"cyan\", \"red\"), legend=c(\"찬성\", \"반대\"))\ntext(x=c(0.7, 1.9, 1.9, 3.1, 3.1), y=c(0.5, 0.3, 0.8, 0.15, 0.65), labels=c(2, 35, 26, 6982, 14013))\n```\n\n- mosaicplot()으로 수효의 차이가 너무 커서 비교하기 어려움.\n\n```{r fig.width=12, fig.height=6}\nmosaicplot(xtabs(counts~class+vote, data=sejong.poll.kr.2[region==\"충청\",], drop=T), col=color, main=\"\", xlab=\"계급\", ylab=\"찬반\")\ntitle(main=\"충청도의 찬반\")\n```\n\n- 작업 디렉토리의 이미지와 히스토리를 저장하고 퇴장.\n\n```\nsave.image(file=\"sejong_poll0328.rda\")\nsavehistory(file=\"sejong_poll0328.Rhistory\")\nq(\"no\")\n```\n\n\n",
    "created" : 1447253923089.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2781631824",
    "id" : "D57B529D",
    "lastKnownWriteTime" : 1447253953,
    "path" : "~/Desktop/Works/Class/Case_Studies_in_Stat/R.WD/Sejong/R/Sejong_poll_kr0422.Rmd",
    "project_path" : "R/Sejong_poll_kr0422.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}