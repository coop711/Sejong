---
title: "Sejong_Poll"
author: "coop711"
date: "2015년 3월 12일"
output: html_document
---

Data
======

- Display All 

```{r}
load("sejong_poll.rda")
sejong.poll[4:1]
```

- The total

```{r}
xtabs(counts~vote,data=sejong.poll)[2:1]
round(prop.table(xtabs(counts~vote,data=sejong.poll)[2:1]),digits=3)
```

- Set orders

```{r}
o.vote<-c(2,1)
o.class<-c(2,1,4,5,3)
o.region<-c(9,10,2,8,5,1,7,4,3,6)
```

- By class

```{r}
xtabs(counts~vote+class,data=sejong.poll)[2:1,c(2,1,4,5,3)]
round(prop.table(xtabs(counts~vote+class,data=sejong.poll)[o.vote,o.class],margin=2),digits=3)
```

- By Region

```{r}
xtabs(counts~vote+region,data=sejong.poll)[o.vote,o.region]
round(prop.table(xtabs(counts~vote+region,data=sejong.poll)[o.vote,o.region],margin=2),digits=3)
```

- Flattened table

```{r}
ftable(xtabs(counts~vote+class+region,data=sejong.poll)[o.vote,o.class,o.region])
```

- Regionwise proportion, check that the coloumn sum calculates up to 1.

```{r}
ftable(round(prop.table(xtabs(counts~vote+class+region,data=sejong.poll)[o.vote,o.class,o.region],margin=3),digits=3))
```

- Classwise proportion, check that the sum for each class calculates up to 1. This is not what we want. 

```{r}
ftable(round(prop.table(xtabs(counts~vote+class+region,data=sejong.poll)[o.vote,o.class,o.region],margin=2),digits=3))
```

- To compare the vote for each class in each region, and for the convenience of viewing, rearrange the variables, and the margin. See the NaNs.

```{r}
ftable(xtabs(counts~class+vote+region,data=sejong.poll)[o.class,o.vote,o.region])

ftable(round(prop.table(xtabs(counts~class+vote+region,data=sejong.poll)[o.class,o.vote,o.region],margin=c(1,3)),digits=3))
```